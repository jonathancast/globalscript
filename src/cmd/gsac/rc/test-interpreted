#! /usr/local/plan9/bin/rc -e

. $GLOBALSCRIPT/bin/test-fns

. $GLOBALSCRIPT/bin/globalscript

ok_grep_script_errors '-- gsac-deps: Completely empty .cgs file --' deps-empty-cgs 'empty.cgs:\$: No #type: prefix or #type: document pragma' ibio ./gslib ./gsac-deps.ags -l $GLOBALSCRIPT/gslib ./test-fixtures/empty.gsac
ok_grep_script_errors '-- gsac-deps: Document with no entry point --' deps-no-entry 'no-entry.cgs:\$: Un-expected EOF; expected symbol' ibio ./gslib ./gsac-deps.ags -l $GLOBALSCRIPT/gslib ./test-fixtures/no-entry.gsac

ok_diff_script '-- gsac-deps: Empty document --' deps-empty-doc ibio ./gslib ./gsac-deps.ags -l ./test-fixtures/gslib ./test-fixtures/empty-doc.gsac
ok_diff_script '-- gsac-deps: Empty list.t document --' deps-empty-list-doc ibio ./gslib ./gsac-deps.ags -l ./test-fixtures/gslib ./test-fixtures/empty-list-doc.gsac

ok_diff_script '-- gsac: Empty document --' gsac-empty-doc ibio ./gslib ./gsac.ags -l ./test-fixtures/gslib ./test-fixtures/empty-doc.cgs
ok_diff_script '-- gsac: Empty bool.t document --' gsac-empty-bool-doc ibio ./gslib ./gsac.ags -l ./test-fixtures/gslib ./test-fixtures/empty-bool-doc.cgs
ok_diff_script '-- gsac: Empty list.t document --' gsac-empty-list-doc ibio ./gslib ./gsac.ags -l ./test-fixtures/gslib ./test-fixtures/empty-list-doc.cgs

ok_grep_script_errors '-- gsac: Empty document w/ unknown type variable --' gsac-empty-doc-unkn-type-var './test-fixtures/empty-doc-unkn-type-var.cgs:3:1: Unknown type variable' ibio ./gslib ./gsac.ags -l ./test-fixtures/gslib ./test-fixtures/empty-doc-unkn-type-var.cgs
